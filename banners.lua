local stdnse = require "stdnse"

_ENV = stdnse.module("banners", stdnse.seeall)

function lookupDistro(sig)
  local map = {}
  local distro
  stdnse.debug1("sig: %s", sig )
  map["Apache httpd 1.3.6 %(Unix%) %(Mandrake/Linux%)"] = "Mandrake Linux 6.0"
  map["Apache httpd 1.3.9 %(Unix%) %(NetRevolution Advanced Server/Linux-Mandrake%)"] = "Mandrake Linux 6.1"
  map["Apache httpd 1.3.9 %(Unix%) %(NetRevolution Advanced Server/Linux-Mandrake%)"] = "Mandrake Linux 7.0"
  map["Apache-AdvancedExtranetServer/1.3.12 %(NetRevolution/Linux-Mandrake%)"] = "Mandrake Linux 7.1"
  map["Apache-AdvancedExtranetServer/1.3.14 %(Linux-Mandrake/"] = "Mandrake Linux 7.2"
  map["Apache-AdvancedExtranetServer/1.3.19 %(Linux-Mandrake/"] = "Mandrake Linux 8.0"
  map["Apache-AdvancedExtranetServer/1.3.20 %(Mandrake Linux/"] = "Mandrake Linux 8.1"
  map["Apache-AdvancedExtranetServer/1.3.22 %(Mandrake Linux/"] = "Mandrake Linux 7.1"
  map["Apache-AdvancedExtranetServer/1.3.22 %(Mandrake Linux/"] = "Mandrake Linux 7.2"
  map["Apache-AdvancedExtranetServer/1.3.22 %(Mandrake Linux/"] = "Mandrake Linux 8.0"
  map["Apache-AdvancedExtranetServer/1.3.22 %(Mandrake Linux/"] = "Mandrake Linux 8.1"
  map["Apache-AdvancedExtranetServer/1.3.23 %(Mandrake Linux/"] = "Mandrake Linux 8.2"
  map["Apache-AdvancedExtranetServer/1.3.26 %(Mandrake Linux/"] = "Mandrake Linux 9.0"
  map["Apache-AdvancedExtranetServer/1.3.27 %(Mandrake Linux/"] = "Mandrake Linux 9.1"
  map["Apache-AdvancedExtranetServer/2.0.44 %(Mandrake Linux/"] = "Mandrake Linux 9.1"
  map["Apache-AdvancedExtranetServer/2.0.47 %(Mandrake Linux/"] = "Mandrake Linux 9.1"
  map["Apache-AdvancedExtranetServer/1.3.28 %(Mandrake Linux/"] = "Mandrake Linux 9.2"
  map["Apache-AdvancedExtranetServer/2.0.47 %(Mandrake Linux/"] = "Mandrake Linux 9.2"
  map["Apache-AdvancedExtranetServer/1.3.29 %(Mandrake Linux/"] = "Mandrake Linux 10.0"
  map["Apache-AdvancedExtranetServer/2.0.48 %(Mandrake Linux/"] = "Mandrake Linux 10.0"
  map["Apache-AdvancedExtranetServer/1.3.31 %(Linux-Mandrake/"] = "Mandrake Linux 10.1"
  map["Apache-AdvancedExtranetServer/2.0.50 %(Mandrake Linux/"] = "Mandrake Linux 10.0"
  map["Apache-AdvancedExtranetServer/2.0.50 %(Mandrake Linux/"] = "Mandrake Linux 10.1"
  map["Apache-AdvancedExtranetServer/2.0.53 %(Mandriva Linux/"] = "Mandriva Linux 2005"
  map["Apache-AdvancedExtranetServer/2.0.54 %(Mandriva Linux/"] = "Mandriva Linux 2006"
  map["Apache-AdvancedExtranetServer/2.2.3 %(Mandriva Linux/"] = "Mandriva Linux 2007"
  map["Apache-AdvancedExtranetServer/2.2.4 %(Mandriva Linux/"] = "Mandriva Linux 2007.1"
  map["Apache httpd 2.2.6 %(Mandriva Linux/PREFORK-8.2mdv2008.0%)"] = "Mandriva Linux 2008.0"
  map["Apache httpd 2.2.9 %(Mandriva Linux/PREFORK-12.9mdv2009.0%)"] = "Mandriva Linux 2009.0"
  map["Apache httpd 2.2.14 %(Mandriva Linux/PREFORK-1.5mdv2010.0%)"] = "Mandriva Linux 2010.0"
  map["Apache httpd 2.2.15 %(Mandriva Linux/PREFORK-3.1mdv2010.1%)"] = "Mandriva Linux 2010.1"
  map["Apache httpd 2.2.15 %(Mandriva Linux/PREFORK-3.1mdv2010.1%)"] = "Mandriva Linux 2010.2"
  map["Apache httpd 2.2.15 %(Mandriva Linux/PREFORK-3.2mdv2010.2%)"] = "Mandriva Linux 2010.2"
  map["Apache httpd 2.2.22 %(Mandriva Linux/PREFORK-0.1mdv2010.2%)"] = "Mandriva Linux 2010.2"
  map["Apache httpd 2.2.22 %(Mandriva Linux/PREFORK-0.1%)"] = "Mandriva Linux 2011.0"
  map["Apache httpd 2.2.24 %(Mandriva Linux/PREFORK-0.1%)"] = "Mandriva Linux 2011.0" 
  map["Apache httpd 2.2.23 %(Mandriva/PREFORK-1.mbs1%)"] = "Mandriva Business Server 1"
  map["Apache httpd 2.2.17 %(Mageia/PREFORK-4.mga1%)"] = "Mageia 1"
  map["Apache httpd 2.2.22 %(Mageia/PREFORK-12.mga2%)"] = "Mageia 2"
  map["Apache httpd 2.4.4 %(Mageia%)"] = "Mageia 3"
  map["Apache httpd 2.4.7 %(Mageia%)"] = "Mageia 4"
  map["Apache httpd 1.2.6 Red Hat"] = "Red Hat Linux 5.1"
  map["Apache httpd 1.3.3 %(Unix%) %(Red Hat/Linux%)"] = "Red Hat Linux 5.2"
  map["Apache httpd 1.3.6 %(Unix%) %(Red Hat/Linux%)"] = "Red Hat Linux 6.0"
  map["Apache httpd 1.3.9 %(Unix%) %(Red Hat/Linux%)"] = "Red Hat Linux 6.1"
  map["Apache httpd 1.3.12 %(Unix%) %(Red Hat/Linux%)"] = "Red Hat Linux 6.2"
  map["Apache httpd 1.3.12 %(Unix%) %(Red Hat/Linux%)"] = "Red Hat Linux 7.0"
  map["Apache httpd 1.3.19 %(Unix%) %(Red-Hat/Linux%)"] = "Red Hat Linux 7.1"
  map["Apache httpd 1.3.20 %(Unix%) %(Red-Hat/Linux%)"] = "Red Hat Linux 7.2"
  map["Apache httpd 1.3.23 %(Unix%) %(Red-Hat/Linux%)"] = "Red Hat Linux 7.3"
  map["Apache httpd 2.0.40 %(Red Hat Linux%)"] = "Red Hat Linux 8.0"
  map["Apache httpd 2.0.40 %(Red Hat Linux%)"] = "Red Hat Linux 9"
  map["Apache httpd 1.3.22 %(Unix%)  (Red-Hat/Linux%)"] = "Red Hat Enterprise Linux 2.1"
  map["Apache httpd 1.3.27 %(Unix%)  (Red-Hat/Linux%)"] = "Red Hat Enterprise Linux 2.1"
  map["Apache httpd 2.0.46 %(Red Hat%)"] = "Red Hat Enterprise Linux 3"
  map["Apache httpd 2.0.46 %(CentOS%)"] = "CentOS 3"
  map["Apache httpd 2.0.52 %(Red Hat%)"] = "Red Hat Enterprise Linux 4"
  map["Apache httpd 2.0.52 %(CentOS%)"] = "CentOS 4"
  map["Apache httpd 2.2.3 %(Red Hat%)"] = "Red Hat Enterprise Linux 5"
  map["Apache httpd 2.2.3 %(CentOS%)"] = "CentOS 5"
  map["Apache httpd 2.2.15 %(CentOS%)"] = "CentOS 6"
  map["Apache httpd 2.4.6 %(CentOS%)"] = "CentOS 7"
  map["Apache httpd 2.2.15 %(Red Hat%)"] = "Red Hat Enterprise Linux 6"
  map["Apache httpd 2.0.52 %(Oracle%)"] = "Oracle Unbreakable Linux 4" 
  map["Apache httpd 2.2.3 %(Oracle%)"] = "Oracle Enterprise Linux 5"
  map["Apache httpd 2.2.15 %(Oracle%)"] = "Oracle Linux 6"
  map["Apache httpd 2.4.6 %(Red Hat%)"] = "Oracle Linux 7"
  map["Apache httpd 2.0.46 %(Scientific Linux%)"] = "Scientific Linux 3"
  map["Apache httpd 2.0.52 %(Scientific Linux%)"] = "Scientific Linux 4"
  map["Apache httpd 2.2.3 %(Scientific Linux%)"] = "Scientific Linux 5"
  map["Apache httpd 2.2.15 %(Scientific Linux%)"] = "Scientific Linux 6"
  map["Apache httpd 2.4.6 %(Scientific Linux%)"] = "Scientific Linux 7"
  map["Apache httpd 2.4.6 %(Red Hat%)"] = "Red Hat Enterprise Linux 7"
  map["Apache httpd 2.4.6 %(Red Hat Enterprise Linux%)"] = "Red Hat Enterprise Linux 7"
  map["Apache httpd 1.3.6 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 6.1"
  map["Apache httpd 1.3.9 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 6.2"
  map["Apache httpd 1.3.12 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 6.4"
  map["Apache httpd 1.3.12 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 7.0"
  map["Apache httpd 1.3.17 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 7.1"
  map["Apache httpd 1.3.19 %(Unix%) %(SuSE/Linux%)"] = "SuSE Linux 7.2"
  map["Apache httpd 1.3.20 %(Linux/SuSE%)"] = "SuSE Linux 7.3"
  map["Apache httpd 1.3.23 %(Linux/SuSE%)"] = "SuSE Linux 8.0"
  map["Apache httpd 1.3.26 %(Linux/SuSE%)"] = "SuSE Linux 8.1"
  map["Apache httpd 1.3.27 %(Linux/SuSE%)"] = "SuSE Linux 8.2"
  map["Apache httpd 1.3.28 %(Linux/SUSE%)"] = "SuSE Linux 9.0"
  map["Apache httpd 2.0.40 %(Linux/SuSE%)"] = "SuSE Linux 8.1"
  map["Apache httpd 2.0.44 %(Linux/SuSE%)"] = "SuSE Linux 8.2"
  map["Apache httpd 2.0.47 %(Linux/SuSE%)"] = "SuSE Linux 9.0"
  map["Apache httpd 2.0.48 %(Linux/SuSE%)"] = "SuSE Linux 8.1"
  map["Apache httpd 2.0.48 %(Linux/SuSE%)"] = "SuSE Linux 8.2"
  map["Apache httpd 2.0.48 %(Linux/SuSE%)"] = "SuSE Linux 9.0"
  map["Apache httpd 2.0.49 %(Linux/SuSE%)"] = "SuSE Linux 9.1"
  map["Apache httpd 2.0.50 %(Linux/SUSE%)"] = "SuSE Linux 9.2"
  map["Apache httpd 2.0.53 %(Linux/SUSE%)"] = "SuSE Linux 9.3"
  map["Apache httpd 2.0.59 %(Linux/SuSE%)"] = "SuSE Linux 9.4"
  map["Apache httpd 2.0.54 %(Linux/SUSE%)"] = "SuSE Linux 10.0"
  map["Apache httpd 2.2.0 %(Linux/SUSE%)"] = "SuSE Linux 10.1"
  map["Apache httpd 2.2.3 %(Linux/SUSE%)"] = "SuSE Linux 10.2"
  map["Apache httpd 2.2.3 %(Linux/SUSE%)"] = "SLES10"
  map["Apache httpd 2.2.4 %(Linux/SUSE%)"] = "SuSE Linux 10.3"
  map["Apache httpd 2.2.3 %(Linux/SUSE%)"] = "SuSE Linux 10.4"
  map["Apache httpd 2.2.10 %(Linux/SUSE%)"] = "SuSE Linux 11.0"
  map["Apache httpd 2.2.10 %(Linux/SUSE%)"] = "SuSE Linux 11.1"
  map["Apache httpd 2.2.12 %(Linux/SUSE%)"] = "SuSE Linux 11.1"
  map["Apache httpd 2.2.12 %(Linux/SUSE%)"] = "SuSE Linux 11.3"
  map["Apache httpd 2.4.10 %(Linux/SUSE%)"] = "SuSE Linux 12.0"
  map["Apache httpd 2.2.17 %(Linux/SUSE%)"] = "openSUSE Linux 11.4"
  map["Apache httpd 2.2.21 %(Linux/SUSE%)"] = "openSUSE Linux 12.1"
  map["Apache httpd 2.2.22 %(Linux/SUSE%)"] = "openSUSE Linux 12.2"
  map["Apache httpd 2.2.22 %(Linux/SUSE%)"] = "openSUSE Linux 12.3"
  map["Apache httpd 2.4.16 %(Linux/SUSE%)"] = "openSUSE Linux 42.1"
  map["Apache httpd 2.0.47 %(Fedora%)"] = "Fedora Core 1"
  map["Apache httpd 2.0.48 %(Fedora%)"] = "Fedora Core 1"
  map["Apache httpd 2.0.49 %(Fedora%)"] = "Fedora Core 1"
  map["Apache httpd 2.0.50 %(Fedora%)"] = "Fedora Core 1"
  map["Apache httpd 2.0.49 %(Fedora%)"] = "Fedora Core 2"
  map["Apache httpd 2.0.50 %(Fedora%)"] = "Fedora Core 2"
  map["Apache httpd 2.0.51 %(Fedora%)"] = "Fedora Core 2"
  map["Apache httpd 2.0.52 %(Fedora%)"] = "Fedora Core 3"
  map["Apache httpd 2.0.54 %(Fedora%)"] = "Fedora Core 4"
  map["Apache httpd 2.2.0 %(Fedora%)"] = "Fedora Core 5"
  map["Apache httpd 2.2.3 %(Fedora%)"] = "Fedora Core 6"
  map["Apache httpd 2.2.4 %(Fedora%)"] = "Fedora 7"
  map["Apache httpd 2.2.8 %(Fedora%)"] = "Fedora 7"
  map["Apache httpd 2.2.6 %(Fedora%)"] = "Fedora 8"
  map["Apache httpd 2.2.9 %(Fedora%)"] = "Fedora 9"
  map["Apache httpd 2.2.11 %(Fedora%)"] = "Fedora 10"
  map["Apache httpd 2.2.11 %(Fedora%)"] = "Fedora 11"
  map["Apache httpd 2.2.14 %(Fedora%)"] = "Fedora 12"
  map["Apache httpd 2.2.15 %(Fedora%)"] = "Fedora 12"
  map["Apache httpd 2.2.15 %(Fedora%)"] = "Fedora 13"
  map["Apache httpd 2.2.16 %(Fedora%)"] = "Fedora 13"
  map["Apache httpd 2.2.17 %(Fedora%)"] = "Fedora 13"
  map["Apache httpd 2.2.16 %(Fedora%)"] = "Fedora 14"
  map["Apache httpd 2.2.17 %(Fedora%)"] = "Fedora 14"
  map["Apache httpd 2.2.17 %(Fedora%)"] = "Fedora 15"
  map["Apache httpd 2.2.19 %(Fedora%)"] = "Fedora 15"
  map["Apache httpd 2.2.21 %(Fedora%)"] = "Fedora 15"
  map["Apache httpd 2.2.22 %(Fedora%)"] = "Fedora 15"
  map["Apache httpd 2.2.21 %(Fedora%)"] = "Fedora 16"
  map["Apache httpd 2.2.22 %(Fedora%)"] = "Fedora 16"
  map["Apache httpd 2.2.22 %(Fedora%)"] = "Fedora 17"
  map["Apache httpd 2.2.23 %(Fedora%)"] = "Fedora 17"
  map["Apache httpd 2.4.3 %(Fedora%)"] = "Fedora 18"
  map["Apache httpd 2.4.4 %(Fedora%)"] = "Fedora 18"
  map["Apache httpd 2.4.6 %(Fedora%)"] = "Fedora 18"
  map["Apache httpd 2.4.4 %(Fedora%)"] = "Fedora 19"
  map["Apache httpd 2.4.6 %(Fedora%)"] = "Fedora 19"
  map["Apache httpd 2.4.7 %(Fedora%)"] = "Fedora 19"
  map["Apache httpd 2.4.6 %(Fedora%)"] = "Fedora 20"
  map["Apache httpd 2.4.10 %(Fedora%)"] = "Fedora 21"
  map["Apache httpd 2.4.16 %(Fedora%)"] = "Fedora 21"
  map["Apache httpd 2.4.12 %(Fedora%)"] = "Fedora 22"
  map["Apache httpd 2.4.18 %(Fedora%)"] = "Fedora 22"
  map["Apache httpd 2.4.17 %(Fedora%)"] = "Fedora 23"
  map["Apache httpd 1.0.5 %(Unix%) Debian/GNU"] = "Debian 1.1 (buzz)"
  map["Apache httpd 1.1.1 %(Unix%) Debian/GNU"] = "Debian 1.2 (rex)"
  map["Apache httpd 1.1.3 %(Unix%) Debian/GNU"] = "Debian 1.3 (bo)"
  map["Apache httpd 1.3.0 %(Unix%) Debian/GNU"] = "Debian 2.0 (hamm)"
  map["Apache httpd 1.3.3 %(Unix%) Debian/GNU"] = "Debian 2.1 (slink)"
  map["Apache httpd 1.3.9 %(Unix%) Debian/GNU"] = "Debian 2.2 (potato)"
  map["Apache httpd 1.3.26 %(Unix%) Debian GNU/Linux"] = "Debian 3.0 (woody)"
  map["Apache httpd 1.3.33 %(Unix%) Debian GNU/Linux"] = "Debian 3.1 (sarge)"
  map["Apache httpd 1.3.34 %(Debian%)"] = "Debian 4.0 (etch)"
  map["Apache httpd 2.0.54 %(Unix%) Debian GNU/Linux"] = "Debian 3.1 (sarge)"
  map["Apache httpd 2.2.3 %(Debian%)"] = "Debian 4.0 (etch)"
  map["Apache httpd 2.2.9 %(Debian%)"] = "Debian 5.0 (lenny)"
  map["Apache httpd 2.2.16 %(Debian%)"] = "Debian 6.0 (squeeze)"
  map["Apache httpd 2.2.22 %(Debian%)"] = "Debian 7.0 (wheezy)"
  map["Apache httpd 2.4.10 %(Debian%)"] = "Debian 8.0 (jessie)"
  map["Apache httpd 1.3.33 %(Unix%) Debian GNU/Linux"] = "Debian unstable (sid)"
  map["Apache httpd 2.0.55 %(Unix%) Debian GNU/Linux"] = "Debian unstable (sid)"
  map["Apache httpd 2.2.22 %(Debian%)"] = "Debian unstable (sid)"
  map["Apache httpd 2.2.22 %(Debian%)"] = "Debian testing (wheezy)"
  map["Apache httpd 2.0.50 %(Ubuntu%)"] = "Ubuntu 4.10 (warty)"
  map["Apache httpd 2.0.53 %(Ubuntu%)"] = "Ubuntu 5.04 (hoary)"
  map["Apache httpd 2.0.54 %(Ubuntu%)"] = "Ubuntu 5.10 (breezy)"
  map["Apache httpd 2.0.55 %(Ubuntu%)"] = "Ubuntu 6.06 (dapper)"
  map["Apache httpd 2.0.55 %(Ubuntu%)"] = "Ubuntu 6.10 (edgy)"
  map["Apache httpd 2.2.3 %(Ubuntu%)"] = "Ubuntu 7.10 (feisty)"
  map["Apache httpd 2.2.8 %(Ubuntu%)"] = "Ubuntu 8.04 (gutsy)"
  map["Apache httpd 2.2.9 %(Ubuntu%)"] = "Ubuntu 8.10 (intrepid)"
  map["Apache httpd 2.2.11 %(Ubuntu%)"] = "Ubuntu 9.04 (jaunty)"
  map["Apache httpd 2.2.12 %(Ubuntu%)"] = "Ubuntu 9.10 (karmic)"
  map["Apache httpd 2.2.14 %(Ubuntu%)"] = "Ubuntu 10.04 (lucid)"
  map["Apache httpd 2.2.16 %(Ubuntu%)"] = "Ubuntu 10.10 (maverick)"
  map["Apache httpd 2.2.17 %(Ubuntu%)"] = "Ubuntu 11.04 (natty)"
  map["Apache httpd 2.2.20 %(Ubuntu%)"] = "Ubuntu 11.10 (oneiric)"
  map["Apache httpd 2.2.22 %(Ubuntu%)"] = "Ubuntu 12.04 (precise)"
  map["Apache httpd 2.2.22 %(Ubuntu%)"] = "Ubuntu 12.10 (quantal)"
  map["Apache httpd 2.2.22 %(Ubuntu%)"] = "Ubuntu 13.04 (raring)"
  map["Apache httpd 2.4.6 %(Ubuntu%)"] = "Ubuntu 13.10 (saucy)"
  map["Apache httpd 2.4.7 %(Ubuntu%)"] = "Ubuntu 14.04 (trusty)"
  map["Apache httpd 2.4.10 %(Ubuntu%)"] = "Ubuntu 14.10 (utopic)"
  map["Apache httpd 2.4.10 %(Ubuntu%)"] = "Ubuntu 15.04 (vivid)"
  map["Apache httpd 2.4.12 %(Ubuntu%)"] = "Ubuntu 15.10 (wily)"
  map["Apache httpd 2.4.18 %(Ubuntu%)"] = "Ubuntu 16.04 (xenial)"
  map["Apache httpd 2.0.52 %(Trustix Secure Linux/Linux%)"] = "Trustix 2.2 (Sunchild)"
  for k,v in pairs(map) do 
    if sig:match(k) then 
      distro = map[k]
    end 
  end
  return distro
end

return _ENV;
